<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="tyche-login">
  <template>
    <style>
        :host{
            display: flex;
            flex: 1;
            align-items: center;
            justify-content: center;
        }
        :host paper-button{
            margin-top: 2px;
        }
    </style>
    <h1>Tyche</h1>
    <paper-button on-click="login">
        Log in
    </paper-button>
  </template>

  <script>
    class TycheLogin extends Polymer.Element {
        static get is() { return 'tyche-login'; }
        static get properties() {
            return {
                loggedin: {
                    type: Boolean,
                    notify: true
                }
            };
        }
        login() {
            // var CLIENT_ID = '630899033557-ptlvvjngen8flpmaqmnj73k06hj9ddck.apps.googleusercontent.com';
            // var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];
            // var SCOPES = "https://www.googleapis.com/auth/calendar.readonly";
            //
            // gapi.load('client:auth2',  function () {
            //   gapi.client.init({
            //     clientId: CLIENT_ID,
            //     scope: SCOPES
            //   }).then(function () {
            //     // Listen for sign-in state changes.
            //     gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
            //
            //     // Handle the initial sign-in state.
            //     updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            //     authorizeButton.onclick = handleAuthClick;
            //     signoutButton.onclick = handleSignoutClick;
            //   });
            // })
            let provider = new firebase.auth.GoogleAuthProvider();
            provider.addScope('email');
            provider.addScope('https://www.googleapis.com/auth/calendar.readonly');

            firebase.auth().signInWithPopup(provider)
            .then((response) => {
                console.log(response);
                this.loggedin = true;
            })
            .catch((error) => {
                console.log(error);
            })
        }
        ready () {
            super.ready();
        }
    }

    window.customElements.define(TycheLogin.is, TycheLogin);
  </script>
</dom-module>
